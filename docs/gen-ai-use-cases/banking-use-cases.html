<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Generative AI Use Cases in Banking ‚Äì Deep Generative Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-a14e3238c51140e99ccc48519b6ed9ce.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="stylesheet" href="styles.css">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Deep Generative Models</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://changezakram.github.io/"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary-of-use-cases" id="toc-summary-of-use-cases" class="nav-link active" data-scroll-target="#summary-of-use-cases"><span class="header-section-number">1</span> üìã Summary of Use Cases</a></li>
  <li><a href="#customer-engagement" id="toc-customer-engagement" class="nav-link" data-scroll-target="#customer-engagement"><span class="header-section-number">2</span> üè¶ Customer Engagement</a></li>
  <li><a href="#operational-efficiency" id="toc-operational-efficiency" class="nav-link" data-scroll-target="#operational-efficiency"><span class="header-section-number">3</span> üìä Operational Efficiency</a></li>
  <li><a href="#risk-management" id="toc-risk-management" class="nav-link" data-scroll-target="#risk-management"><span class="header-section-number">4</span> üîê Risk Management</a></li>
  <li><a href="#credit-approval-and-loan-underwriting" id="toc-credit-approval-and-loan-underwriting" class="nav-link" data-scroll-target="#credit-approval-and-loan-underwriting"><span class="header-section-number">5</span> üìù Credit Approval and Loan Underwriting</a></li>
  <li><a href="#personalized-marketing" id="toc-personalized-marketing" class="nav-link" data-scroll-target="#personalized-marketing"><span class="header-section-number">6</span> üì£ Personalized Marketing</a></li>
  <li><a href="#generative-business-intelligence-gen-bi" id="toc-generative-business-intelligence-gen-bi" class="nav-link" data-scroll-target="#generative-business-intelligence-gen-bi"><span class="header-section-number">7</span> üìà Generative Business Intelligence (Gen BI)</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">8</span> üßæ Key Takeaways</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">9</span> üìö References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Generative AI Use Cases in Banking</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Generative AI is redefining how banks operate ‚Äî from automating customer service to streamlining underwriting. Below are practical examples showing how leading financial institutions are applying GenAI for real business value.</p>
<section id="summary-of-use-cases" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="summary-of-use-cases"><span class="header-section-number">1</span> üìã Summary of Use Cases</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 36%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Use Case Area</th>
<th>Examples</th>
<th>Benefits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Customer Engagement</td>
<td>Erica, Cora+, Fargo, Eliza</td>
<td>24/7 support, lower call volume</td>
</tr>
<tr class="even">
<td>Operational Efficiency</td>
<td>LLM Suite, AskResearchGPT, PwC</td>
<td>Process streamlining, reduced manual work</td>
</tr>
<tr class="odd">
<td>Risk Management</td>
<td>Mastercard DI, Wells Fargo Fraud</td>
<td>Early fraud detection, loss prevention</td>
</tr>
<tr class="even">
<td>Credit Underwriting</td>
<td>CreditLens, COiN Platform</td>
<td>Quicker approvals, lower compliance risk</td>
</tr>
<tr class="odd">
<td>Personalized Marketing</td>
<td>JPMorgan Campaigns</td>
<td>Better targeting, higher engagement</td>
</tr>
<tr class="even">
<td>Generative BI</td>
<td>Copilot, ThoughtSpot, Custom Assistants</td>
<td>Self-service insights, exec summaries</td>
</tr>
</tbody>
</table>
</section>
<section id="customer-engagement" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="customer-engagement"><span class="header-section-number">2</span> üè¶ Customer Engagement</h2>
<div class="callout callout-style-simple callout-none no-icon" title="">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Why it matters:</strong><br>
Generative AI enables banks to deliver faster, more intelligent, and more personalized customer service. By automating routine interactions and offering real-time assistance, banks can improve customer satisfaction, reduce support costs, and scale their service capabilities without increasing headcount.</p>
</div>
</div>
</div>
<p><strong>Examples:</strong><br>
- Bank of America ‚Äì Erica: Offers financial guidance through natural language interactions, helping users with budgeting, transactions, and account management.<br>
- NatWest ‚Äì Cora+: Anticipates customer needs and provides proactive responses using conversational AI.<br>
- Wells Fargo ‚Äì Fargo: Supports English and Spanish to help customers manage cards and access banking services via natural language.<br>
- BNY Mellon ‚Äì Eliza: Internal chatbot and tooling platform used by 52,000 employees to build GenAI-powered apps like lead generation tools.</p>
</section>
<section id="operational-efficiency" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="operational-efficiency"><span class="header-section-number">3</span> üìä Operational Efficiency</h2>
<div class="callout callout-style-simple callout-none no-icon" title="">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Why it matters:</strong><br>
Banks deal with vast volumes of reports, compliance documentation, and internal knowledge. Generative AI improves productivity by summarizing documents, automating workflows, and assisting developers ‚Äî freeing employees to focus on higher-value tasks and accelerating project delivery.</p>
</div>
</div>
</div>
<p><strong>Examples:</strong><br>
- JPMorgan ‚Äì LLM Suite: Automates document summarization, content creation, and reporting.<br>
- Morgan Stanley ‚Äì AskResearchGPT: Provides natural language access to 70,000+ research reports.<br>
- PwC ‚Äì Compliance Automation: Uses GenAI to summarize regulatory documents and extract clauses.<br>
- Citi ‚Äì Reporting Automation: Streamlines compliance reporting and data extraction.<br>
- Citigroup ‚Äì AI Tools for Developers: Boosts engineering productivity with GenAI code assistance.</p>
</section>
<section id="risk-management" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="risk-management"><span class="header-section-number">4</span> üîê Risk Management</h2>
<div class="callout callout-style-simple callout-none no-icon" title="">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Why it matters:</strong><br>
Fraud detection and risk modeling are core to banking safety. GenAI enhances traditional models by spotting subtle anomalies, synthesizing potential fraud scenarios, and enabling faster investigation of suspicious transactions.</p>
</div>
</div>
</div>
<p><strong>Examples:</strong><br>
- Mastercard ‚Äì Decision Intelligence: Evaluates over 1 trillion data points in real time to approve 143+ billion transactions annually.<br>
- Wells Fargo ‚Äì AI for Fraud: Uses GenAI for enhanced anomaly detection in transactional data.</p>
</section>
<section id="credit-approval-and-loan-underwriting" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="credit-approval-and-loan-underwriting"><span class="header-section-number">5</span> üìù Credit Approval and Loan Underwriting</h2>
<div class="callout callout-style-simple callout-none no-icon" title="">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Why it matters:</strong><br>
Credit underwriting involves reviewing complex financial documents and assessing risk within tight timeframes. Generative AI helps automate the analysis of financial statements, legal documents, and industry benchmarks, enabling faster loan decisions, improved accuracy, and streamlined compliance.</p>
</div>
</div>
</div>
<p><strong>Examples:</strong><br>
- Moody‚Äôs Analytics ‚Äì CreditLens: Automates credit memo creation and industry analysis with generative tools.<br>
- JPMorgan Chase ‚Äì COiN Platform: Uses GenAI to analyze legal contracts in seconds, reducing loan underwriting time.</p>
</section>
<section id="personalized-marketing" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="personalized-marketing"><span class="header-section-number">6</span> üì£ Personalized Marketing</h2>
<div class="callout callout-style-simple callout-none no-icon" title="">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Why it matters:</strong><br>
Generative AI enables banks to move beyond mass marketing and deliver personalized, data-driven messaging. This improves customer engagement, increases conversion rates, and enhances long-term loyalty.</p>
</div>
</div>
</div>
<p><strong>Examples:</strong><br>
- JPMorgan Chase ‚Äì Hyper-personalized Campaigns: Uses GenAI to create individualized marketing materials.</p>
</section>
<section id="generative-business-intelligence-gen-bi" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="generative-business-intelligence-gen-bi"><span class="header-section-number">7</span> üìà Generative Business Intelligence (Gen BI)</h2>
<div class="callout callout-style-simple callout-none no-icon" title="">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Why it matters:</strong><br>
Generative BI transforms data consumption by allowing non-technical users to explore reports, uncover insights, and ask ad hoc questions using natural language ‚Äî all without waiting on analysts. This boosts data literacy and speeds up decision-making across business units.</p>
</div>
</div>
</div>
<p><strong>Examples:</strong><br>
- Microsoft Copilot in Power BI: Enables users to ask natural-language questions and instantly generate charts or summaries.<br>
- ThoughtSpot Sage: Combines search with GenAI to explain patterns and alert users to anomalies.<br>
- Internal Gen BI tools: Many banks are building custom assistants on top of Snowflake, BigQuery, or Lakehouse environments to support executive dashboards and ops reviews.</p>
</section>
<section id="key-takeaways" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="key-takeaways"><span class="header-section-number">8</span> üßæ Key Takeaways</h2>
<ul>
<li>GenAI is no longer experimental in banking ‚Äî it‚Äôs powering real customer-facing and internal systems.</li>
<li>Use cases like customer engagement, underwriting, and Gen BI deliver measurable productivity and experience gains.</li>
<li>As the industry matures, GenAI will likely integrate deeper into core banking platforms and regulatory processes.</li>
</ul>
</section>
<section id="references" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="references"><span class="header-section-number">9</span> üìö References</h2>
<p>Bank of America. (2024). <em>Erica: Virtual Financial Assistant</em>. https://info.bankofamerica.com/en/digital-banking/erica</p>
<p>Citigroup. (2019). <em>Citi Global Trade uses AI to digitize compliance in next-generational project</em>. https://www.citigroup.com/global/news/press-release/2019/citi-global-trade-uses-ai-to-digitie-compliance-in-next-generational-project</p>
<p>Citi Ventures. (2024). <em>Investing in Poolside</em>. https://www.citi.com/ventures/perspectives/pressrelease/investing-in-poolside.html</p>
<p>CTO Magazine. (2024). <em>JP Morgan Chase accelerates AI adoption</em>. https://ctomagazine.com/jp-morgan-chase-accelerates-ai-adoption/</p>
<p>Futurism. (2024). <em>An AI completed 360,000 hours of finance work in just seconds</em>. https://futurism.com/an-ai-completed-360000-hours-of-finance-work-in-just-seconds</p>
<p>Mastercard. (2024, February). <em>Mastercard supercharges consumer protection with Gen AI</em>. https://www.mastercard.com/news/press/2024/february/mastercard-supercharges-consumer-protection-with-gen-ai/</p>
<p>Microsoft Power BI. (2023). <em>Introducing Copilot in Power BI</em>. https://powerbi.microsoft.com/en-us/blog/introducing-microsoft-fabric-and-copilot-in-microsoft-power-bi/</p>
<p>Moody‚Äôs Analytics. (2024). <em>Revolutionizing loan origination with GenAI</em>. https://www.moodys.com/web/en/us/insights/lending/revolutionizing-loan-origination-with-genai.html</p>
<p>Morgan Stanley. (2024a). <em>AI at Morgan Stanley Debrief launch</em>. https://www.morganstanley.com/press-releases/ai-at-morgan-stanley-debrief-launch</p>
<p>Morgan Stanley. (2024b). <em>Morgan Stanley Research announces AskResearchGPT</em>. https://www.morganstanley.com/press-releases/morgan-stanley-research-announces-askresearchgpt</p>
<p>NatWest Group. (2024, June). <em>NatWest launches Cora+: The latest generative AI upgrade to their digital assistant</em>. https://www.natwestgroup.com/news-and-insights/news-room/press-releases/data-and-technology/2024/jun/natwest-launches-cora-plus-the-latest-generative-ai-upgrade-to-t.html</p>
<p>PwC. (2023). <em>Building trust in AI for tax compliance</em>. https://www.pwc.com/gx/en/services/tax/connected-tax-compliance/build-trust-ai-tax-compliance.html</p>
<p>ThoughtSpot. (2024). <em>Introducing ThoughtSpot Sage</em>. https://www.thoughtspot.com/product/sage</p>
<p>Wall Street Journal. (2024a). <em>BNY signs multiyear deal with OpenAI</em>. https://www.wsj.com/articles/bny-americas-oldest-bank-signs-multiyear-deal-with-openai-74987d1d</p>
<p>Wall Street Journal. (2024b). <em>Inside OpenAI‚Äôs deal with BBVA</em>. https://www.wsj.com/articles/six-months-thousands-of-gpts-and-some-big-unknowns-inside-openais-deal-with-bbva-5d6f1c03</p>
<p>Wells Fargo. (2024). <em>Meet Fargo: AI-powered banking assistant</em>. https://sites.wf.com/fargo/</p>
<p>Wells Fargo Stories. (2024). <em>How AI could reshape banking</em>. https://stories.wf.com/artificial-intelligence-has-the-potential-to-reshape-banking/</p>



</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>