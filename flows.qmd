---
title: "Normalizing Flow Models"
format: html
---

# Normalizing Flow Models

Normalizing Flows are a class of generative models that transform a simple base distribution into a complex one using a sequence of invertible, differentiable mappings. To understand how they work, we begin with a key mathematical tool: the **change of variables formula**.

## Math Review: Change of Variables in 1D

Suppose we have a **random variable** $z$ with a known distribution $p_Z(z)$, and we define a new variable:

$$
x = f(z)
$$

where $f$ is a **monotonic, differentiable** function with an inverse:

$$
z = f^{-1}(x) = h(x)
$$

Our goal is to compute the probability density function (PDF) of $x$, denoted $p_X(x)$, in terms of the known PDF $p_Z(z)$.

### Step 1: Cumulative Distribution Function (CDF)

We begin with the cumulative distribution function of $x$:

$$
F_X(x) = P(X \leq x) = P(f(Z) \leq x)
$$

Since $f$ is monotonic and invertible, this becomes:

$$
P(f(Z) \leq x) = P(Z \leq f^{-1}(x)) = F_Z(h(x))
$$

### Step 2: Deriving the PDF via Chain Rule

To obtain the PDF, we differentiate the CDF:

$$
p_X(x) = \frac{d}{dx} F_X(x) = \frac{d}{dx} F_Z(h(x))
$$

Applying the chain rule:

$$
p_X(x) = F_Z'(h(x)) \cdot h'(x) = p_Z(h(x)) \cdot h'(x)
$$

### Step 3: Expressing $h'(x)$ Using $f$

Recall that $z = h(x) = f^{-1}(x)$. Using the **inverse function theorem**, we write:

$$
h'(x) = \frac{d}{dx} f^{-1}(x) = \frac{1}{f'(z)} = \frac{1}{f'(f^{-1}(x))}
$$

So the full expression becomes:

$$
p_X(x) = p_Z(f^{-1}(x)) \cdot \left| \frac{1}{f'(f^{-1}(x))} \right|
$$

Note the **absolute value**: we include it because the derivative $f'(z)$ might be negative if the transformation is decreasing, but **probability densities must always be non-negative**. The absolute value ensures the result remains a valid PDF.

### Final Form (1D Case)

The final formula — which is the 1D version of the change-of-variables rule — is:

$$
p_X(x) = p_Z(f^{-1}(x)) \cdot \left| \frac{d}{dx} f^{-1}(x) \right|
$$

This is the fundamental tool Normalizing Flows use to model complex distributions by transforming simple ones.
